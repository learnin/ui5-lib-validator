//@ui5-bundle learnin/ui5/validator/library-preload.js
/*!
 * ${copyright}
 */
sap.ui.predefine("learnin/ui5/validator/library", ["sap/ui/core/library"],()=>{"use strict";return sap.ui.getCore().initLibrary({name:"learnin.ui5.validator",version:"0.3.6",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["learnin.ui5.validator.Validator"],elements:[],noLibraryCSS:true})});
sap.ui.require.preload({
	"learnin/ui5/validator/SapMTableUtil.js":function(){
"use strict";sap.ui.define(["sap/m/Table"],function(e){class t{static getLabelText(t,n){const i=n.getParent();if(i instanceof e){const e=n.indexOfCell(t);if(e!==-1){const t=i.getColumns().filter(e=>e.getVisible())[e].getHeader();if("getText"in t&&typeof t.getText==="function"){return t.getText()}}}return undefined}}return t});
},
	"learnin/ui5/validator/Validator.js":function(){
"use strict";sap.ui.define(["sap/base/util/deepExtend","sap/base/util/uid","sap/m/CheckBox","sap/m/ColumnListItem","sap/m/IconTabFilter","sap/m/Input","sap/ui/base/Object","sap/ui/core/Control","sap/ui/core/Element","sap/ui/core/LabelEnablement","sap/ui/core/library","sap/ui/core/message/ControlMessageProcessor","sap/ui/core/message/Message","sap/ui/model/json/JSONModel","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/table/Column","sap/ui/table/Row","sap/ui/table/Table","sap/ui/model/ListBinding","sap/ui/model/SimpleType","sap/ui/model/ParseException","sap/ui/model/ValidateException","./SapMTableUtil"],function(e,t,a,i,s,n,r,o,l,d,g,c,f,u,h,_,I,p,T,V,y,C,m,S){function A(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const E=l["registry"];const R=g["MessageType"];const M=g["ValueState"];const x=A(S);const b=(t,a,i)=>{let s;return n=>{if(s){clearTimeout(s)}const r=e({},n);s=setTimeout(()=>a.call(t,r),i)}};const w=e=>{if(Array.isArray(e)){return e}return[e]};const v=e=>{if(e===null||e===undefined){throw new SyntaxError("Argument is not a Column or Columns.")}const t=w(e);if(t.some(e=>!(e instanceof I))){throw new SyntaxError("Argument is neither a Column nor Columns.")}};class B extends r{RESOURCE_BUNDLE_KEY_REQUIRED_INPUT="learnin.ui5.validator.Validator.message.requiredInput";RESOURCE_BUNDLE_KEY_REQUIRED_SELECT="learnin.ui5.validator.Validator.message.requiredSelect";_CUSTOM_DATA_KEY_FOR_IS_SET_VALUE_STATE_ERROR="learnin.ui5.validator.Validator.IS_SET_VALUE_STATE_ERROR";_aTargetAggregations=["items","content","form","formContainers","formElements","fields","sections","subSections","app","pages","_grid","_page","cells","contentAreas"];_mInvalidTableRowCols=new Map;constructor(e){super();this._mRegisteredValidator=new Map;this._mControlIdAttachedValidator=new Map;this._sTableIdAttachedRowsUpdated=new Set;this._fnDebouncedRenewValueStateInTable=null;if(e&&e.resourceBundle){this._resourceBundle=e.resourceBundle}if(e&&e.targetAggregations){if(Array.isArray(e.targetAggregations)){e.targetAggregations.forEach(e=>{if(!this._aTargetAggregations.includes(e)){this._aTargetAggregations.push(e)}})}else{if(!this._aTargetAggregations.includes(e.targetAggregations)){this._aTargetAggregations.push(e.targetAggregations)}}}this._useFocusoutValidation=true;if(e&&e.useFocusoutValidation===false){this._useFocusoutValidation=false}}validate(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{isDoConstraintsValidation:false};if(this._useFocusoutValidation){this._attachValidator(e)}return this._validate(e,t.isDoConstraintsValidation)}removeErrors(e){if(!e){throw new SyntaxError}if(!(e instanceof o)&&!(e instanceof h)&&!(e instanceof _)&&!(e instanceof s)){return}const t=sap.ui.getCore().getMessageManager();const a=t.getMessageModel();const i=F.getMetadata().getName();const n=a.getProperty("/").filter(e=>r.isA(e,i));const l=e.getId();for(let e=0,a=n.length;e<a;e++){const a=n[e];const i=a.getValidationErrorControlIds();if(!i.some(e=>E.get(e))){t.removeMessages(a);continue}i.forEach(e=>{const i=E.get(e);if(this._isChildOrEqualControlId(i,l)){t.removeMessages(a)}})}this._mInvalidTableRowCols.forEach((e,t)=>{const a=E.get(t);if(a&&this._isChildOrEqualControlId(a,l)){this._mInvalidTableRowCols.delete(t)}});E.forEach((e,t)=>{if(e instanceof o&&this._isSetValueStateError(e)&&this._isChildOrEqualControlId(e,l)){this._clearValueStateIfNoErrors(e,this._resolveMessageTarget(e))}})}removeAttachedValidators(e){if(!e){throw new SyntaxError}if(!(e instanceof o)&&!(e instanceof h)&&!(e instanceof _)&&!(e instanceof s)){return}const t=e.getId();this._mControlIdAttachedValidator.forEach((e,a)=>{const i=E.get(a);if(!i||!(i instanceof o)){return}if(this._isChildOrEqualControlId(i,t)){this._detachAllValidators(i)}});this._sTableIdAttachedRowsUpdated.forEach(e=>{const a=E.get(e);if(!a||!(a instanceof T)){return}if(this._isChildOrEqualControlId(a,t)){if(this._fnDebouncedRenewValueStateInTable){a.detachRowsUpdated(this._fnDebouncedRenewValueStateInTable,this)}a.detachSort(this._clearInValidRowColsInTable,this);a.detachFilter(this._clearInValidRowColsInTable,this);a.detachModelContextChange(this._clearInValidRowColsInTable,this);this._sTableIdAttachedRowsUpdated.delete(e)}})}registerValidator(e,a,i,s,n,r){if(typeof e==="string"){return this._registerValidator(false,e,a,i,s,n,r)}return this._registerValidator(true,t(),e,a,i,s,n)}_registerValidator(e,t,a,i,s,n,r){if(!(!Array.isArray(s)&&!Array.isArray(i)||Array.isArray(s)&&!Array.isArray(i)||Array.isArray(s)&&Array.isArray(i)&&i.length==s.length)){throw new SyntaxError}if(Array.isArray(s)&&r&&r.controlsMoreAttachValidator){throw new SyntaxError}if(r&&!r.isAttachValidator&&r.isAttachFocusoutValidationImmediately){throw new SyntaxError}const o={isAttachValidator:true,isAttachFocusoutValidationImmediately:true,isGroupedTargetControls:false,controlsMoreAttachValidator:null};const l=Object.assign({},o,r);let d=false;let g;if(!Array.isArray(s)&&s instanceof I&&s.getParent().getBinding("rows")&&s.getParent().getBinding("rows").getModel()instanceof u||Array.isArray(s)&&s[0]instanceof I&&s[0].getParent().getBinding("rows")&&s[0].getParent().getBinding("rows").getModel()instanceof u){if(Array.isArray(s)&&l.isGroupedTargetControls){throw new SyntaxError}d=true;g=e=>{v(e.targetControlOrControls);const t=w(e.targetControlOrControls);const i=t[0].getParent();const s=i.getBinding("rows");const n=s.getPath();const r=s.getModel().getProperty(n);const o=i.getRows();if(r.length===0||o.length===0){return true}const l=t.map(e=>e.getId());const d=[];i.getColumns().filter(e=>e.getVisible()).forEach((e,t)=>{if(l.includes(e.getId())){d.push(t)}});if(d.length===0){return true}const g=o[0].getCells().filter((e,t)=>d.includes(t));const c=g.map(e=>this._resolveBindingPropertyName(e));if(c.includes(undefined)){return true}const f=g.map(e=>this._getLabelText(e));const u=Array.isArray(e.targetControlOrControls);let h=true;if(e.isGroupedTargetControls){const i=[];const s=[];for(let e=0,t=r.length;e<t;e++){i.push(r[e][g[0].getBindingPath(c[0])]);s.push(e)}if(!a(i)){h=false;this._addMessageAndInvalidTableRowCol(t,n,s,e.messageTextOrMessageTexts,f,e.validateFunctionId)}}else{for(let i=0,s=r.length;i<s;i++){let s;if(u){s=g.map((e,t)=>r[i][e.getBindingPath(c[t])])}else{s=r[i][g[0].getBindingPath(c[0])]}if(a(s)){continue}h=false;this._addMessageAndInvalidTableRowCol(t,n,[i],e.messageTextOrMessageTexts,f,e.validateFunctionId)}}return h}}else{g=e=>{const t=e.targetControlOrControls;if(a(t)){return true}const i=e.messageTextOrMessageTexts;const s=e.validateFunctionId;if(Array.isArray(t)){if(e.isGroupedTargetControls){const e=Array.isArray(i)?i[0]:i;this._addMessage(t,e,s);for(let a=0;a<t.length;a++){this._setValueState(t[a],M.Error,e)}return false}for(let e=0;e<t.length;e++){const a=Array.isArray(i)?i[e]:i;this._addMessage(t[e],a,s);this._setValueState(t[e],M.Error,a)}}else{this._addMessage(t,i,s);this._setValueState(t,M.Error,i)}return false}}const c=n.getId();if(this._mRegisteredValidator.has(c)){const n=this._mRegisteredValidator.get(c);const r=n.find(a=>e&&a.isOriginalFunctionIdUndefined&&i===a.messageTextOrMessageTexts||!e&&!a.isOriginalFunctionIdUndefined&&a.validateFunctionId===t);if(r){r.testFunction=a;r.messageTextOrMessageTexts=i;r.targetControlOrControls=s;r.validateFunction=g;r.isGroupedTargetControls=l.isGroupedTargetControls;r.controlsMoreAttachValidator=l.controlsMoreAttachValidator;r.isOriginalFunctionIdUndefined=e;r.isAttachValidator=l.isAttachValidator}else{n.push({validateFunctionId:t,testFunction:a,messageTextOrMessageTexts:i,targetControlOrControls:s,validateFunction:g,isGroupedTargetControls:l.isGroupedTargetControls,controlsMoreAttachValidator:l.controlsMoreAttachValidator,isOriginalFunctionIdUndefined:e,isAttachValidator:l.isAttachValidator})}}else{this._mRegisteredValidator.set(c,[{validateFunctionId:t,testFunction:a,messageTextOrMessageTexts:i,targetControlOrControls:s,validateFunction:g,isGroupedTargetControls:l.isGroupedTargetControls,controlsMoreAttachValidator:l.controlsMoreAttachValidator,isOriginalFunctionIdUndefined:e,isAttachValidator:l.isAttachValidator}])}if(l.isAttachValidator&&l.isAttachFocusoutValidationImmediately){if(d){if(Array.isArray(s)){const e=s;const n=e[0].getParent();const r=e.map(e=>e.getId());const o=[];n.getColumns().filter(e=>e.getVisible()).forEach((e,t)=>{if(r.includes(e.getId())){o.push(t)}});if(o.length>0){n.getRows().forEach(e=>{const s=e.getCells().filter((e,t)=>o.includes(t));this._attachRegisteredValidator(s,a,i,t,l.isGroupedTargetControls,l.controlsMoreAttachValidator)})}}else{const e=s;const n=e.getParent();const r=n.getColumns().filter(e=>e.getVisible()).findIndex(t=>t.getId()===e.getId());if(r>0){const e=n.getRows().map(e=>e.getCells()[r]);if(l.isGroupedTargetControls){this._attachRegisteredValidator(e,a,i,t,l.isGroupedTargetControls,l.controlsMoreAttachValidator)}else{e.forEach(e=>{this._attachRegisteredValidator(e,a,i,t,l.isGroupedTargetControls,l.controlsMoreAttachValidator)})}}}}else{this._attachRegisteredValidator(s,a,i,t,l.isGroupedTargetControls,l.controlsMoreAttachValidator)}}return this}registerRequiredValidator(e,a,i,s,n){if(typeof e==="string"){return this._registerRequiredValidator(e,a,i,s,n)}return this._registerRequiredValidator(t(),e,a,i,s)}_registerRequiredValidator(e,t,a,i,s){const n={isAttachFocusoutValidationImmediately:false,isGroupedTargetControls:false,controlsMoreAttachValidator:null};const r=Object.assign({},n,s);let o;if(Array.isArray(a)){if(r.controlsMoreAttachValidator){throw new SyntaxError}if(r.isGroupedTargetControls){o=this._getRequiredErrorMessageTextByControl(a[0])}else{o=a.map(e=>this._getRequiredErrorMessageTextByControl(e))}}else{o=this._getRequiredErrorMessageTextByControl(a)}this.registerValidator(e,t,o,a,i,r);return this}unregisterValidator(e,t){const a=t.getId();if(!this._mRegisteredValidator.has(a)){return this}const i=this._mRegisteredValidator.get(a);const s=i.findIndex(t=>t.validateFunctionId===e);if(s>=0){i.splice(s,1)}if(i.length===0){this._mRegisteredValidator.delete(a)}return this}_attachValidator(e){if(!(e instanceof o||e instanceof h||e instanceof _||e instanceof s)){return}if(e instanceof o&&d.isRequired(e)){this._attachNotRegisteredValidator(e)}if(this._mRegisteredValidator.has(e.getId())){this._mRegisteredValidator.get(e.getId()).forEach(t=>{if(t.isAttachValidator){if(e instanceof T&&e.getBinding("rows")&&e.getBinding("rows").getModel()instanceof u){const a=e;if(Array.isArray(t.targetControlOrControls)){const e=t.targetControlOrControls;const i=e.map(e=>e.getId());const s=[];a.getColumns().filter(e=>e.getVisible()).forEach((e,t)=>{if(i.includes(e.getId())){s.push(t)}});if(s.length>0){a.getRows().forEach(e=>{const a=e.getCells().filter((e,t)=>s.includes(t));this._attachRegisteredValidator(a,t.testFunction,t.messageTextOrMessageTexts,t.validateFunctionId,t.isGroupedTargetControls,t.controlsMoreAttachValidator)})}}else{const e=t.targetControlOrControls;const i=a.getColumns().filter(e=>e.getVisible()).findIndex(t=>t.getId()===e.getId());if(i>0){const e=a.getRows().map(e=>e.getCells()[i]);if(t.isGroupedTargetControls){this._attachRegisteredValidator(e,t.testFunction,t.messageTextOrMessageTexts,t.validateFunctionId,t.isGroupedTargetControls,t.controlsMoreAttachValidator)}else{e.forEach(e=>{this._attachRegisteredValidator(e,t.testFunction,t.messageTextOrMessageTexts,t.validateFunctionId,t.isGroupedTargetControls,t.controlsMoreAttachValidator)})}}}}else{this._attachRegisteredValidator(t.targetControlOrControls,t.testFunction,t.messageTextOrMessageTexts,t.validateFunctionId,t.isGroupedTargetControls,t.controlsMoreAttachValidator)}}})}if(e instanceof T){const t=e.getBinding();if(t&&t instanceof V){const a=e.getRows();for(let e=0,i=t.getLength();e<i;e++){if(a[e]){const t=a[e].getCells();if(t){for(let e=0;e<t.length;e++){this._attachValidator(t[e])}}}}}}else{for(let t=0;t<this._aTargetAggregations.length;t++){const a=e.getAggregation(this._aTargetAggregations[t]);if(!a){continue}if(Array.isArray(a)){for(let e=0;e<a.length;e++){const t=a[e];if(t instanceof o||t instanceof h||t instanceof _||t instanceof s){this._attachValidator(t)}}}else if(a instanceof o||a instanceof h||a instanceof _||a instanceof s){this._attachValidator(a)}}}}_validate(e,t){let a=true;const i=e.getId();if(!((e instanceof o||e instanceof h||e instanceof _||e instanceof s)&&e.getVisible())){if(!this._callRegisteredValidator(e)){a=false}return a}if(e instanceof T&&e.getBinding("rows")&&e.getBinding("rows").getModel()instanceof u){a=this._validateRequiredInSapUiTableTable(e)}else if(e instanceof T){const i=e.getBinding("rows");if(i&&i instanceof V){const s=e.getRows();for(let e=0,n=i.getLength();e<n;e++){if(s[e]){const i=s[e].getCells();if(i){for(let e=0;e<i.length;e++){if(!this._validate(i[e],t)){a=false}}}}}}}else{if(e instanceof o&&("getEnabled"in e&&typeof e.getEnabled==="function"&&e.getEnabled()||!("getEnabled"in e))){if(d.isRequired(e)){a=this._validateRequired(e)}if(t&&!this._isNullValue(e)){const t=this._resolveBindingPropertyName(e);const i=e.getBindingInfo(t);if(i&&"type"in i&&i.type instanceof y){const s=i.type;const n=e.getMetadata().getPropertyLikeSetting(t);let o=null;if("altTypes"in n&&Array.isArray(n.altTypes)){o=n.altTypes[0]}else if("type"in n){o=n.type}try{if(t==="dateValue"&&"getDateValue"in e&&typeof e.getDateValue==="function"){if(o){i.type.parseValue(e.getDateValue(),o)}i.type.validateValue(e.getDateValue())}else if(t==="value"&&"getValue"in e&&typeof e.getValue==="function"){if(o){i.type.parseValue(e.getValue(),o)}i.type.validateValue(e.getValue())}else if(t==="selectedKey"&&"getSelectedKey"in e&&typeof e.getSelectedKey==="function"){if(o){i.type.parseValue(e.getSelectedKey(),o)}i.type.validateValue(e.getSelectedKey())}else if(t==="selectedKeys"&&"getSelectedKeys"in e&&typeof e.getSelectedKeys==="function"){if(o){i.type.parseValue(e.getSelectedKeys(),o)}i.type.validateValue(e.getSelectedKeys())}else if(t==="selected"&&"getSelected"in e&&typeof e.getSelected==="function"){if(o){i.type.parseValue(e.getSelected(),o)}i.type.validateValue(e.getSelected())}else if(t==="selectedIndex"&&"getSelectedIndex"in e&&typeof e.getSelectedIndex==="function"){if(o){i.type.parseValue(e.getSelectedIndex(),o)}i.type.validateValue(e.getSelectedIndex())}else if(t==="selectedDates"&&"getSelectedDates"in e&&typeof e.getSelectedDates==="function"){if(o){i.type.parseValue(e.getSelectedDates(),o)}i.type.validateValue(e.getSelectedDates())}else if(t==="text"&&"getText"in e&&typeof e.getText==="function"){if(o){i.type.parseValue(e.getText(),o)}i.type.validateValue(e.getText())}}catch(t){if(t instanceof C||t instanceof m){if("message"in t&&typeof t.message==="string"){const i=sap.ui.getCore().getMessageManager();const s=F.getMetadata().getName();const n=i.getMessageModel().getProperty("/").some(a=>!r.isA(a,s)&&a.getControlId()===e.getId()&&a.getMessage()===t.message);if(!n){i.addMessages(new f({message:t.message,type:R.Error,additionalText:this._getLabelText(e),processor:new c,target:this._resolveMessageTarget(e),fullTarget:""}));if("setValueState"in e&&typeof e.setValueState==="function"){e.setValueState(M.Error)}if("setValueStateText"in e&&typeof e.setValueStateText==="function"){e.setValueStateText(t.message)}}a=false}}}}}}for(let i=0;i<this._aTargetAggregations.length;i++){const n=e.getAggregation(this._aTargetAggregations[i]);if(!n){continue}if(Array.isArray(n)){for(let e=0;e<n.length;e++){const i=n[e];if(i instanceof o||i instanceof h||i instanceof _||i instanceof s){if(!this._validate(i,t)){a=false}}}}else if(n instanceof o||n instanceof h||n instanceof _||n instanceof s){if(!this._validate(n,t)){a=false}}}}if(!this._callRegisteredValidator(e)){a=false}return a}_toVisibledColumnIndex(e,t){const a=e.getColumns();const i=e=>{let t=0;for(let i=0,s=Math.min(a.length,e+1);i<s;i++){if(!a[i].getVisible()){t++}}return e-t};let s=t;let n=true;if(!Array.isArray(s)){n=false;s=[s]}const r=[];for(let e=0,t=s.length;e<t;e++){r.push(i(s[e]))}return r}_renewValueStateInTable(e){const t=e.getSource();if(!(t instanceof T)){return}const a=this._mInvalidTableRowCols.get(t.getId());if(!a){return}const i=Array.from(new Set(a.map(e=>e.columnId)));let s=[];for(let e=0,a=i.length;e<a;e++){const a=E.get(i[e]);if(!a||!(a instanceof I)||!a.getVisible()){continue}s.push(t.indexOfColumn(a))}s=this._toVisibledColumnIndex(t,s);const n=t.getRows();for(let e=0,t=s.length;e<t;e++){for(let t=0,a=n.length;t<a;t++){this._setValueState(n[t].getCells()[s[e]],M.None,null)}}if(!("model"in t.getBindingInfo("rows"))){return}const r=t.getBindingInfo("rows").model;for(let e=0,i=a.length;e<i;e++){const i=E.get(a[e].columnId);if(!i||!(i instanceof I)||!i.getVisible()){continue}const s=this._toVisibledColumnIndex(t,t.indexOfColumn(i))[0];const n=t.getRows().find(t=>t.getCells()[s].getBindingContext(r).getPath()===a[e].rowPath);if(n){const t=n.getCells()[s];this._setValueState(t,M.Error,a[e].message)}}}_clearInValidRowColsInTable(e){const t=e.getSource();if(!("getId"in t)||typeof t.getId!=="function"){return}const a=t.getId();if(this._mInvalidTableRowCols.has(a)){this._mInvalidTableRowCols.delete(a)}}_addMessageAndInvalidTableRowCol(e,t,a,i,s,n){let r=false;const o=w(i);e.forEach((e,i)=>{const s=e.getParent().getId();const l=e.getId();let d=this._mInvalidTableRowCols.get(s);if(!d){d=[];this._mInvalidTableRowCols.set(s,d)}a.forEach(e=>{if(!d.some(t=>t.rowIndex===e&&t.columnId===l&&t.validateFunctionId===n)){d.push({rowPath:`${t}/${e}`,rowIndex:e,columnId:l,message:o[i],validateFunctionId:n})}else if(i===0){r=true}})});if(!r){this._addMessageByColumn(e[0],o[0],n,`${t}/${a[0]}`,s.join(", "))}}_attachTableRowsUpdater(e){if(this._sTableIdAttachedRowsUpdated.has(e.getId())){return}if(!this._fnDebouncedRenewValueStateInTable){this._fnDebouncedRenewValueStateInTable=b(this,this._renewValueStateInTable,100)}e.attachRowsUpdated(this._fnDebouncedRenewValueStateInTable,this);e.attachSort(this._clearInValidRowColsInTable,this);e.attachFilter(this._clearInValidRowColsInTable,this);e.attachModelContextChange(this._clearInValidRowColsInTable,this);this._sTableIdAttachedRowsUpdated.add(e.getId())}_callRegisteredValidator(e){let t=true;const a=e.getId();let i=false;if(this._mRegisteredValidator.has(a)){this._mRegisteredValidator.get(a).forEach(a=>{if(!a.validateFunction(a)){t=false;if(e instanceof T){i=true}}})}if(i){this._attachTableRowsUpdater(e)}return t}_attachNotRegisteredValidator(e){if(!("attachSelectionFinish"in e)&&!("attachChange"in e)&&!("attachSelect"in e)){return}const t=e.getId();if(this._isAttachedValidator(t,"")){return}const a=this._getRequiredErrorMessageTextByControl(e);this._internalAttachValidator(e,"",a)}_attachRegisteredValidator(e,t,a,i,s,n){let r;if(!Array.isArray(e)){r=[e]}else if(e.length===0){return}else{r=e}for(let e=0;e<r.length;e++){const o=r[e];const l=o.getId();if(this._isAttachedValidator(l,i)){continue}let d;if(s){d=Array.isArray(a)?a[0]:a}else{d=Array.isArray(a)?a[e]:a}const g={targetControl:o,messageText:d,test:t,controls:r,validateFunctionId:i,isGroupedTargetControls:s,messageTextOrMessageTexts:a};this._internalAttachValidator(o,i,g);if(n&&e===0){let e;if(!Array.isArray(n)){e=[n]}else{e=n}for(let t=0;t<e.length;t++){const a=e[t];const s=a.getId();if(this._isAttachedValidator(s,i)){continue}this._internalAttachValidator(a,i,g)}}}}_isAttachedValidator(e,t){const a=this._mControlIdAttachedValidator.get(e);if(!a){return false}return a.includes(t)}_internalAttachValidator(e,t,a){const i=e.getId();const s=()=>{const e=this._mControlIdAttachedValidator.get(i);if(e){e.push(t)}else{this._mControlIdAttachedValidator.set(i,[t])}};const n=t=>{if("attachSelectionFinish"in e&&typeof e.attachSelectionFinish==="function"){e.attachSelectionFinish(a,t,this);s()}else if("attachChange"in e&&typeof e.attachChange==="function"){e.attachChange(a,t,this);s()}else if("attachSelect"in e&&typeof e.attachSelect==="function"){e.attachSelect(a,t,this);s()}};if(t===""){n(this._notRegisteredValidator)}else{n(this._registeredvalidator)}}_detachAllValidators(e){const t=e.getId();const a=this._mControlIdAttachedValidator.get(t);if(!a){return}const i=t=>{if("detachSelectionFinish"in e&&typeof e.detachSelectionFinish==="function"){e.detachSelectionFinish(t,this)}else if("detachChange"in e&&typeof e.detachChange==="function"){e.detachChange(t,this)}else if("detachSelect"in e&&typeof e.detachSelect==="function"){e.detachSelect(t,this)}};a.forEach(e=>{if(e===""){i(this._notRegisteredValidator)}else{i(this._registeredvalidator)}});this._mControlIdAttachedValidator.set(t,[])}_notRegisteredValidator(e,t){const a=e.getSource();if(!(a instanceof o)){return}if(this._isNullValue(a)){if(this._isCellInSapUiTableTableBindedJsonModel(a)){this._setErrorCellInSapUiTableTable(a,t,"",false)}else{this._addMessage(a,t)}this._setValueState(a,M.Error,t)}else{if(this._isCellInSapUiTableTableBindedJsonModel(a)){this._clearErrorCellInSapUiTableTable(a,"",false)}else{this._removeMessageAndValueState(a,"")}}}_registeredvalidator(e,t){const a=t.targetControl;const i=t.controls.length>1?t.controls:t.controls[0];let s;if(this._isCellInSapUiTableTableBindedJsonModel(a)&&t.isGroupedTargetControls){const e=a.getParent().getParent();const i=e.getBinding("rows");const n=i.getPath();const r=i.getModel().getProperty(n);const o=this._resolveBindingPropertyName(a);const l=[];for(let e=0;e<r.length;e++){l.push(r[e][a.getBindingPath(o)])}s=t.test(l)}else{s=t.test(i)}if(s){if(this._isCellInSapUiTableTableBindedJsonModel(a)){this._clearErrorCellInSapUiTableTable(t.controls,t.validateFunctionId,t.isGroupedTargetControls)}else{t.controls.forEach(e=>{this._removeMessageAndValueState(e,t.validateFunctionId)})}}else{if(this._isCellInSapUiTableTableBindedJsonModel(a)){this._setErrorCellInSapUiTableTable(t.controls,t.messageText,t.validateFunctionId,t.isGroupedTargetControls)}else if(t.isGroupedTargetControls){this._addMessage(t.controls,t.messageText,t.validateFunctionId);t.controls.forEach(e=>{this._setValueState(e,M.Error,t.messageText)})}else{this._addMessage(a,t.messageText,t.validateFunctionId);this._setValueState(a,M.Error,t.messageText)}}}_isCellInSapUiTableTableBindedJsonModel(e){return e.getParent()&&e.getParent().getParent()instanceof T&&e.getParent().getParent().getBinding("rows")&&e.getParent().getParent().getBinding("rows").getModel()instanceof u}_setErrorCellInSapUiTableTable(e,t,a,i){const s=Array.isArray(e)?e:[e];const n=s[0].getParent();if(!(n instanceof p)){return}const r=n.getParent();if(!(r instanceof T)){return}const o=s.map(e=>n.indexOfCell(e));const l=r.getColumns().filter(e=>e.getVisible()).filter((e,t)=>o.includes(t));const d=r.getBinding("rows");const g=d.getPath();const c=n.getIndex();const f=s.map(e=>this._getLabelText(e));let u=[c];if(Array.isArray(e)&&i){const e=d.getModel().getProperty(g).length;u=[];for(let t=0;t<e;t++){u.push(t)}}this._addMessageAndInvalidTableRowCol(l,g,u,t,f,a);s.forEach(e=>this._setValueState(e,M.Error,t));this._attachTableRowsUpdater(r)}_clearErrorCellInSapUiTableTable(e,t,a){let i;if(!Array.isArray(e)){i=[e]}else if(a){i=[e[0]]}else{i=e}const s=i[0].getParent();const n=s.getParent();const o=n.getId();let l=this._mInvalidTableRowCols.get(o);if(!l){return}const d=i.map(e=>s.indexOfCell(e));const g=n.getColumns().filter(e=>e.getVisible()).filter((e,t)=>d.includes(t));const c=g.map(e=>e.getId());if(!("model"in n.getBindingInfo("rows"))){return}const f=n.getBindingInfo("rows").model;const u=n.getBinding("rows").getPath();const h=d.map(e=>s.getCells()[e].getBindingContext(f).getPath());if(Array.isArray(e)&&a){l=l.filter(e=>!c.includes(e.columnId)||e.validateFunctionId!==t)}else{l=l.filter(e=>!h.includes(e.rowPath)||!c.includes(e.columnId)||e.validateFunctionId!==t)}this._mInvalidTableRowCols.set(o,l);const _=sap.ui.getCore().getMessageManager();const I=_.getMessageModel();const p=F.getMetadata().getName();const T=I.getProperty("/").find(i=>r.isA(i,p)&&i.getControlId()===c[0]&&"fullTarget"in i&&(Array.isArray(e)&&a&&i.fullTarget===`${u}/0`||h.includes(i.fullTarget))&&"getValidateFunctionId"in i&&typeof i.getValidateFunctionId==="function"&&i.getValidateFunctionId()===t);if(T){_.removeMessages(T);if(Array.isArray(e)){e.forEach(e=>this._clearValueStateIfNoErrors(e,this._resolveMessageTarget(e)))}else{this._clearValueStateIfNoErrors(e,this._resolveMessageTarget(e))}}}_validateRequired(e){if(!this._isNullValue(e)){return true}const t=this._getRequiredErrorMessageTextByControl(e);this._addMessage(e,t);this._setValueState(e,M.Error,t);return false}_validateRequiredInSapUiTableTable(e){let t=true;const a=e.getBinding("rows");const i=a.getPath();const s=a.getModel().getProperty(i);const n=e.getRows();if(s.length>0&&n.length>0){const a=n[0].getCells().filter(e=>("getEnabled"in e&&typeof e.getEnabled==="function"&&e.getEnabled()||!("getEnabled"in e))&&d.isRequired(e));if(a.length>0){const r=a.map(e=>this._resolveBindingPropertyName(e));for(let o=0;o<s.length;o++){for(let l=0;l<a.length;l++){if(!r[l]){continue}const d=s[o][a[l].getBindingPath(r[l])];if(r[l]==="selectedIndex"&&d<0||r[l]!=="selectedIndex"&&(d===""||d===null||d===undefined)){t=false;const s=this._getRequiredErrorMessageTextByControl(a[l]);const r=n[0].indexOfCell(a[l]);const d=e.getColumns().filter(e=>e.getVisible())[r];this._addMessageAndInvalidTableRowCol([d],i,[o],s,[this._getLabelText(a[l])],"")}}}}}if(!t){this._attachTableRowsUpdater(e)}e.fireRowsUpdated();return t}_removeMessageAndValueState(e,t){const a=sap.ui.getCore().getMessageManager();const i=a.getMessageModel();const s=F.getMetadata().getName();const n=e.getId();const o=i.getProperty("/").find(e=>r.isA(e,s)&&e.getValidationErrorControlIds().includes(n)&&e.getValidateFunctionId()===t);if(o){a.removeMessages(o)}this._clearValueStateIfNoErrors(e,this._resolveMessageTarget(e))}_clearValueStateIfNoErrors(e,t){if(!("setValueState"in e)){return}const a=w(t);if(a.length===0){return}setTimeout(()=>{const t=sap.ui.getCore().getMessageManager().getMessageModel().getProperty("/");if(a.every(e=>t.some(t=>t.getTargets&&t.getTargets().includes(e)||t.getTarget()===e))){return}if(this._isCellInSapUiTableTableBindedJsonModel(e)){const t=e.getParent();const a=t.getParent();const i=a.getId();let s=this._mInvalidTableRowCols.get(i);if(!s){this._setValueState(e,M.None,null);return}const n=t.indexOfCell(e);const r=a.getColumns().filter(e=>e.getVisible())[n];const o=r.getId();const l=a.getBindingInfo("rows");const d="model"in l?String(l.model):undefined;const g=t.getCells()[n].getBindingContext(d).getPath();const c=s.find(e=>e.rowPath===g&&e.columnId===o);if(c){this._setValueState(e,M.Error,c.message);return}}this._setValueState(e,M.None,null)},1)}_isChildOrEqualControlId(e,t){if(e.getId()===t){return true}let a=e;while(a.getParent()){if(a.getParent().getId()===t){return true}a=a.getParent()}return false}_resolveMessageTarget(e){let t=[];if(Array.isArray(e)){t=e}else{t.push(e)}const a=t.map(e=>{if(e.getBindingInfo("dateValue")){return e.getId()+"/dateValue"}if(e.getBindingInfo("value")){return e.getId()+"/value"}if(e.getBindingInfo("selectedKey")){return e.getId()+"/selectedKey"}if(e.getBindingInfo("selectedKeys")){return e.getId()+"/selectedKeys"}if(e.getBindingInfo("selected")){return e.getId()+"/selected"}if(e.getBindingInfo("selectedIndex")){return e.getId()+"/selectedIndex"}if(e.getBindingInfo("selectedDates")){return e.getId()+"/selectedDates"}if(e.getBindingInfo("text")){return e.getId()+"/text"}return undefined});if(a.length>0){return a}return a[0]}_resolveBindingPropertyName(e){if(e.getBindingInfo("dateValue")){return"dateValue"}if(e.getBindingInfo("value")){return"value"}if(e.getBindingInfo("selectedKey")){return"selectedKey"}if(e.getBindingInfo("selectedKeys")){return"selectedKeys"}if(e.getBindingInfo("selected")){return"selected"}if(e.getBindingInfo("selectedIndex")){return"selectedIndex"}if(e.getBindingInfo("selectedDates")){return"selectedDates"}if(e.getBindingInfo("text")){return"text"}return undefined}_isNullValue(e){if(!("getValue"in e)&&!("getSelectedKey"in e)&&!("getSelectedKeys"in e)&&!("getSelected"in e)&&!("getSelectedIndex"in e)&&!("getSelectedDates"in e)){return false}if("getValue"in e||"getSelectedKey"in e||"getSelectedKeys"in e||"getSelected"in e){return!("getValue"in e&&typeof e.getValue==="function"&&e.getValue()||"getSelectedKey"in e&&typeof e.getSelectedKey==="function"&&e.getSelectedKey()||"getSelectedKeys"in e&&typeof e.getSelectedKeys==="function"&&e.getSelectedKeys().length>0||"getSelected"in e&&typeof e.getSelected==="function"&&e.getSelected())}if("getSelectedIndex"in e&&typeof e.getSelectedIndex==="function"&&e.getSelectedIndex()>=0){return false}if("getSelectedDates"in e&&typeof e.getSelectedDates==="function"){const t=e.getSelectedDates();if(t.length>0&&t[0].getStartDate()){return false}}return true}_getRequiredErrorMessageTextByControl(e){const t="Required to input.";const a="Required to select.";if(e instanceof n){return this._getResourceText(this.RESOURCE_BUNDLE_KEY_REQUIRED_INPUT,t)}if("getSelectedKey"in e||"getSelectedKeys"in e||"getSelected"in e||"getSelectedIndex"in e||"getSelectedDates"in e){return this._getResourceText(this.RESOURCE_BUNDLE_KEY_REQUIRED_SELECT,a)}return this._getResourceText(this.RESOURCE_BUNDLE_KEY_REQUIRED_INPUT,t)}_getResourceText(e,t){if(this._resourceBundle){return this._resourceBundle.getText(e)}return t}_getLabelText(e){if(e instanceof a){const t=e.getParent();if(t&&t instanceof l){const e=d.getReferencingLabels(t);if(e&&e.length>0){const t=E.get(e[0]);if(t&&"getText"in t&&typeof t.getText==="function"){return t.getText()}}}}if(e.getParent){const t=e.getParent();if(t instanceof p){const a=t;const i=a.getParent();if(i instanceof T){const t=a.indexOfCell(e);if(t!==-1){const e=i.getColumns().filter(e=>e.getVisible())[t].getLabel();if(typeof e==="string"){return e}else if("getText"in e&&typeof e.getText==="function"){return e.getText()}}}return undefined}else if(t instanceof i){return x.getLabelText(e,t)}}const t=d.getReferencingLabels(e);if(t&&t.length>0){const e=E.get(t[0]);if("getText"in e&&typeof e.getText==="function"){return e.getText()}}return undefined}_addMessage(e,t,a){let i;let s;if(Array.isArray(e)){i=e[0];s=e}else{i=e;s=[e]}const n=sap.ui.getCore().getMessageManager();const o=n.getMessageModel();const l=F.getMetadata().getName();const d=i.getId();const g=o.getProperty("/").some(e=>r.isA(e,l)&&e.getValidationErrorControlIds().includes(d)&&e.getValidateFunctionId()===a);if(g){return}n.addMessages(new F({message:t,type:R.Error,additionalText:this._getLabelText(i),processor:new c,target:this._resolveMessageTarget(e),fullTarget:"",validationErrorControlIds:s.map(e=>e.getId()),validateFunctionId:a||""}))}_addMessageByColumn(e,t,a,i,s){sap.ui.getCore().getMessageManager().addMessages(new F({message:t,type:R.Error,additionalText:s,processor:new c,target:undefined,fullTarget:i,validationErrorControlIds:[e.getId()],validateFunctionId:a||""}))}_setValueState(e,t,a){if("setValueState"in e&&typeof e.setValueState==="function"){e.setValueState(t);if(t===M.Error){this._markSetValueStateError(e)}else if(t===M.None){this._unmarkSetValueStateError(e)}}if("setValueStateText"in e&&typeof e.setValueStateText==="function"){e.setValueStateText(a)}}_isSetValueStateError(e){return e.data(this._CUSTOM_DATA_KEY_FOR_IS_SET_VALUE_STATE_ERROR)==="true"}_markSetValueStateError(e){e.data(this._CUSTOM_DATA_KEY_FOR_IS_SET_VALUE_STATE_ERROR,"true")}_unmarkSetValueStateError(e){e.data(this._CUSTOM_DATA_KEY_FOR_IS_SET_VALUE_STATE_ERROR,null)}}const F=f.extend("learnin.ui5.validator.Validator._ValidatorMessage",{constructor:function e(t){if(t&&Array.isArray(t.target)){if(!f.prototype.getTargets){const e=t.target;if(t.target.length>0){t.target=t.target[0]}else{delete t.target}f.prototype.constructor.call(this,t);this.targets=e}else{f.prototype.constructor.call(this,t)}}else{f.prototype.constructor.call(this,t)}this.validationErrorControlIds=[];if(t&&t.validationErrorControlIds&&Array.isArray(t.validationErrorControlIds)&&t.validationErrorControlIds.length>0){this.validationErrorControlIds=t.validationErrorControlIds;if("addControlId"in this&&typeof this.addControlId==="function"){this.addControlId(t.validationErrorControlIds[0])}}this.validateFunctionId="";if(t&&t.validateFunctionId){this.validateFunctionId=t.validateFunctionId}},getTargets:function e(){if(f.prototype.getTargets){return f.prototype.getTargets.call(this)}if(this.targets){return this.targets}return[]},getValidationErrorControlIds:function e(){return this.validationErrorControlIds},getValidateFunctionId:function e(){return this.validateFunctionId}});return B});
},
	"learnin/ui5/validator/manifest.json":'{"_version":"1.17.0","sap.app":{"id":"learnin.ui5.validator","type":"library","applicationVersion":{"version":"0.3.6"},"title":"UI5 Validator"},"sap.ui":{"technology":"UI5","deviceTypes":{"desktop":true,"phone":true,"tablet":true}},"sap.ui5":{"contentDensities":{"compact":true,"cozy":true},"dependencies":{"minUI5Version":"1.71.11","libs":{"sap.ui.core":{},"sap.m":{}}}}}'
});
//# sourceMappingURL=library-preload.js.map
